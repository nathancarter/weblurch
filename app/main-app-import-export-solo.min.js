(function(){var e,t,i=[].slice;window.groupMenuItems.wikiimport={text:"Import from wiki...",context:"file",onclick:function(){var t;if(!e()&&(t=prompt("Give the name of the page to import (case sensitive)","Main Page"),null!==t))return tinymce.activeEditor.MediaWiki.importPage(t,function(e,t){return null!=t?tinymce.activeEditor.Settings.document.metadata=t:void 0})}},window.groupMenuItems.wikiexport={text:"Export to wiki",context:"file",onclick:function(){var t,i,o,n,a;if(!e())return i=tinymce.activeEditor.Settings.document.get("wiki_title"),null==i?void tinymce.activeEditor.Dialogs.alert({title:"Page Title not set",message:"<p>You have not yet set the title under which this document should be published on the wiki. See the document settings on the File menu.</p>"}):(a=tinymce.activeEditor.Settings.application.get("wiki_username"),o=tinymce.activeEditor.Settings.application.get("wiki_password"),null==a||null==o?void tinymce.activeEditor.Dialogs.alert({title:"No Wiki Credentials",message:"<p>You have not given your wiki username and password to the application settings.  See the application settings on the File menu.</p>"}):(n=function(e,t){var o,n;return t?void tinymce.activeEditor.Dialogs.alert({title:"Posting Error",message:"<p>Error when posting to the wiki:</p> <p>"+t+"</p>"}):(o=/^[^/]+\/\/[^/]+\//.exec(window.location.href),n=window.location.href.slice(0,o[0].length)+"wiki/index.php?title="+encodeURIComponent(i),tinymce.activeEditor.Dialogs.alert({title:"Document Posted",message:"<p>Posting succeeded.</p> <p><a href='"+n+"' target='_blank'>Visit posted page.</a></p>"}))},t=function(e,t){var o;return t?void tinymce.activeEditor.Dialogs.alert({title:"Wiki Login Error",message:"<p>Error when logging into the wiki:</p> <p>"+t+"</p>"}):(o=tinymce.activeEditor.MediaWiki.embedMetadata(tinymce.activeEditor.getContent(),tinymce.activeEditor.Settings.document.metadata),tinymce.activeEditor.MediaWiki.exportPage(i,o,n))},tinymce.activeEditor.MediaWiki.login(a,o,t)))}},window.afterEditorReadyArray.push(function(e){var i,o,n,a,r,c,d,s;if(e.MediaWiki.setIndexPage("/wiki/index.php"),e.MediaWiki.setAPIPage("/wiki/api.php"),(a=/\?wikipage=(.*)/.exec(window.location.search))&&e.MediaWiki.importPage(decodeURIComponent(a[1],function(t,i){return null!=i?e.LoadSave.loadMetaData(i):void 0})),i="auto-load",(a=/\?autoload=(.*)/.exec(window.location.search))&&(i=decodeURIComponent(a[1])),c=localStorage.getItem(i))try{d=JSON.parse(c),r=d[0],o=d[1],setTimeout(function(){var n,a;return localStorage.removeItem(i),a=/^\s*<shorthand>(.*)<\/shorthand>\s*$/,o=o.replace(/\n|\cJ/g," "),(n=a.exec(o))?t(o):tinymce.activeEditor.setContent(o),e.LoadSave.loadMetaData(r)},100)}catch(l){}return(a=/\?document=(.*)/.exec(window.location.search))?(n=decodeURIComponent(a[1]),s=extractMetadata(n),r=s.metadata,o=s.document,localStorage.setItem("auto-load",JSON.stringify([r,o])),window.location.href=window.location.href.split("?")[0]):void 0}),e=function(){var e;return e=/nathancarter\.github\.io/.test(window.location.href),e&&tinymce.activeEditor.Dialogs.alert({title:"Not Available Here",message:"<p>That functionality requires MediaWiki to be running on the server from which you're accessing this web app.</p> <p>On GitHub, we cannot run a MediaWiki server, so the functionality is disabled.</p> <p>The menu items remain for use in developer testing, as we prepare for a dedicated server that will have MediaWiki and the ability to publish documents to that wiki with a single click, or edit them in Lurch with a single click.</p> <p>Try back soon!</p>"}),e},t=function(e){var t,o,n,a,r,c,d,s,l,u,p,m,g,h,v,w,f,y,k,E,M,b;for(a=tinymce.activeEditor.getDoc(),n=a.createElement("div"),n.innerHTML=e,m={},s={},o={},d={},g=0,h=function(e){var t,i,n,a,r,c,l;return"E"===e.tagName&&(r=g++),c=function(){var i,o,n,a;for(n=e.childNodes,a=[],i=0,o=n.length;o>i;i++)t=n[i],a.push(h(t));return a}(),"E"===e.tagName?(e.hasAttribute("n")&&(a=e.getAttribute("n"),m[a]=r,s[r]=a),e.hasAttribute("at")&&(d[r]=e.getAttribute("at")),e.hasAttribute("to")&&(o[r]=function(){var t,i,o,a;for(o=e.getAttribute("to").split(","),a=[],t=0,i=o.length;i>t;t++)n=o[t],a.push(Number(n));return a}()),grouperHTML("expression","open",r,!1,"")+c.join("")+grouperHTML("expression","close",r,!1,"")):(i=e.cloneNode(!1),i.innerHTML=c.join(""),null!=(l=i.outerHTML)?l:i.textContent)},tinymce.activeEditor.setContent(h(n)),tinymce.activeEditor.Groups.scanDocument(),c=k=g;0>=g?0>=k:k>=0;c=0>=g?++k:--k)if(c in d){if(!(r=tinymce.activeEditor.Groups[c]))continue;l=OM.encodeAsIdentifier(d[c]),u={m:r.completeForm().encode(),v:LZString.compress(r.groupAsHTML(!1))},(t=r.parent.get(l))&&((null!=(b=t.m.children[0])?b.equals(OM.sym("List","Lurch")):void 0)?t.m=OM.app.apply(OM,[t.m.children[0],OM.decode(u.m)].concat(i.call(t.m.children[1]))):t.m=OM.app(OM.sym("List","Lurch"),t.m,OM.decode(u.m)),t.v=u.v+t.v,u=t),r.parent.set(l,u),r.remove()}for(w in o)if(y=o[w],v=tinymce.activeEditor.Groups[w])for(E=0,M=y.length;M>E;E++)p=y[E],(f=tinymce.activeEditor.Groups[m[p]])&&v.connect(f);return tinymce.activeEditor.undoManager.clear()}}).call(this);
//# sourceMappingURL=main-app-import-export-solo.min.js.map