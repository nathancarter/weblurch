(function(){var t,e=[].slice,r=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1},o={}.hasOwnProperty;window.Group.prototype.canonicalForm=function(){var t;return 0===this.children.length?OM.str(this.contentAsCode()):OM.app.apply(OM,function(){var e,r,o,n;for(o=this.children,n=[],e=0,r=o.length;r>e;e++)t=o[e],n.push(t.canonicalForm());return n}.call(this))},window.Group.prototype.attributeGroups=function(t){var e,r,o,n,i,s,u;for(null==t&&(t=!1),o=[],u=this.connectionsIn(),i=0,s=u.length;s>i;i++)if(e=u[i],n=tinymce.activeEditor.Groups[e[0]],r=n.get("key")){if(!t&&"premise"===r)continue;o.push(n)}return o},window.Group.prototype.attributeGroupsForKey=function(t){var e,r,o,n,i;for(n=this.attributeGroups(!0),i=[],r=0,o=n.length;o>r;r++)e=n[r],e.get("key")===t&&i.push(e);return i},window.Group.prototype.attributionAncestry=function(t){var o,n,i,s,u,c,p,a,l;for(null==t&&(t=!1),i=[],a=this.attributeGroups(t),s=0,c=a.length;c>s;s++)for(o=a[s],l=[o].concat(e.call(o.attributionAncestry())),u=0,p=l.length;p>u;u++)n=l[u],r.call(i,n)<0&&i.push(n);return i},window.Group.prototype.listSymbol=OM.sym("List","Lurch"),window.Group.prototype.completeForm=function(t){var r,n,i,s,u,c,p,a,l,h,d,f,g,m,y,v,w,b,G,O;for(null==t&&(t=!1),l=this.canonicalForm(),a={},b=this.attributeGroups(t),f=0,y=b.length;y>f;f++)s=b[f],u=s.get("key"),(null!=a[u]?a[u]:a[u]=[]).push(s);for(G=this.keys(),g=0,v=G.length;v>g;g++)u=G[g],(r=OM.decodeIdentifier(u))&&null==a[r]&&(a[r]=[]);for(u in a)if(o.call(a,u)){for(c=a[u],(n=this.get(OM.encodeAsIdentifier(u)))&&c.push(this),p=[],h=function(t,e){return strictNodeComparator(t.open,e.open)},O=c.sort(h),m=0,w=O.length;w>m;m++)s=O[m],s===this?(i=OM.decode(n.m),"a"===i.type&&i.children[0].equals(Group.prototype.listSymbol)?p=p.concat(i.children.slice(1)):p.push(i)):p.push(s.completeForm(t));l=OM.att(l,OM.sym(u,"Lurch"),1===p.length?p[0]:OM.app.apply(OM,[Group.prototype.listSymbol].concat(e.call(p)))),(d=this.getValidation())&&(l=OM.att(l,OM.sym("validation","Lurch"),OM.str(JSON.stringify(d))))}return l},window.Group.prototype.toJSON=function(){return this.completeForm().encode()},window.Group.prototype.lookupAttributes=function(t){var e,r,o,n,i,s,u,c,p;for(n=this.attributeGroupsForKey(t),(e=this.get(OM.encodeAsIdentifier(t)))&&n.push(this),i=[],s=function(t,e){return strictNodeComparator(t.open,e.open)},p=n.sort(s),u=0,c=p.length;c>u;u++)o=p[u],o===this?(r=OM.decode(e.m),"a"===r.type&&r.children[0].equals(Group.prototype.listSymbol)?i=i.concat(r.children.slice(1)):i.push(r)):i.push(o);return i},window.Group.prototype.embedAttribute=function(t,o){var n,i,s,u;return null==o&&(o=!0),i=function(){var e,r,o,i;for(o=this.attributeGroups(),i=[],e=0,r=o.length;r>e;e++)n=o[e],n.get("key")===t&&i.push(n);return i}.call(this),s=OM.encodeAsIdentifier(t),u={m:1===i.length?i[0].completeForm():OM.app.apply(OM,[Group.prototype.listSymbol].concat(e.call(function(){var t,e,r;for(r=[],t=0,e=i.length;e>t;t++)n=i[t],r.push(n.completeForm());return r}())))},u.m=u.m.encode(),this.plugin.editor.undoManager.transact(function(t){return function(){var c,p,a,l,h,d,f,g,m,y,v,w,b,G,O,M;for(u.v="",m=0,w=i.length;w>m;m++){for(d=i[m],O=d.connectionsOut(),y=0,b=O.length;b>y;y++)h=O[y],g=tinymce.activeEditor.Groups[h[1]],d.disconnect(g);$(d.open).addClass("mustreconnect"),l=d.attributionAncestry(),l.sort(strictNodeComparator),u.v.length>0&&(u.v+="\n"),u.v+=function(){var t,r,o,i;for(o=[d].concat(e.call(l)),i=[],t=0,r=o.length;r>t;t++)n=o[t],i.push(n.groupAsHTML(!1));return i}().join("")}if(u.v=compressWrapper(u.v),t.set(s,u),o){for(M=[],v=0,G=i.length;G>v;v++)d=i[v],d.remove(),l=d.attributionAncestry(),l.sort(strictNodeComparator),a=[d.id()].concat(e.call(function(){var t,e,r;for(r=[],t=0,e=l.length;e>t;t++)c=l[t],r.push(c.id());return r}())),M.push(function(){var t,e,o,n,i,s,u;for(u=[],t=0,e=l.length;e>t;t++){for(p=l[t],f=!1,i=p.connectionsOut(),n=0,o=i.length;o>n;n++)if(h=i[n],s=h[1],r.call(a,s)<0){f=!0;break}u.push(f?void 0:p.remove())}return u}());return M}}}(this))},window.Group.prototype.unembedAttribute=function(t,e){var r,o,n,i,s,u;if(null==e&&(e=!1),u=this.get(OM.encodeAsIdentifier(t))){for(o=decompressWrapper(u.v),i=OM.decode(u.m),r=/class=('[^']*grouper[^']*'|"[^"]*grouper[^"]*")/,s="";n=r.exec(o);)s+=o.substr(0,n.index)+n[0].substr(0,n[0].length-1)+" justPasted"+n[0].substr(n[0].length-1),o=o.substr(n.index+n[0].length);return s+=o,this.plugin.editor.undoManager.transact(function(r){return function(){var o;return e||(o=r.rangeAfter(),o.collapse(!0),r.plugin.editor.selection.setRng(o)),r.plugin.editor.insertContent(s),r.plugin.scanDocument(),$(r.plugin.editor.getDoc()).find(".grouper.mustreconnect").each(function(e,o){var n;return n=r.plugin.grouperToGroup(o),n.connect(r),n.set("key",t),n.get("keyposition")||n.set("keyposition","arrow"),$(o).removeClass("mustreconnect")}),r.clear(OM.encodeAsIdentifier(t))}}(this))}},t=5e4,window.compressWrapper=function(e){var r,o,n,i,s,u,c;for(o=/<img\s+([^>]*)\s+src=('[^']*'|"[^"]*")([^>]*)>/;i=o.exec(e);)e=e.substr(0,i.index)+("<img "+i[1]+" "+i[2]+">")+e.substr(i.index+i[0].length);for(e=LZString.compress(e),s="",n=u=0,c=e.length;c>=0?c>u:u>c;n=c>=0?++u:--u)s+=(r=e.charCodeAt(n))<t?e[n]:String.fromCharCode(5e4)+String.fromCharCode(r-5e4);return s},window.decompressWrapper=function(e){var r,o;for(o="";e.length>0;)(r=e.charCodeAt(0))<t?(o+=e[0],e=e.substr(1)):(o+=String.fromCharCode(r+e.charCodeAt(1)),e=e.substr(2));return LZString.decompress(o)},window.Group.prototype.contentAsCode=function(){var t,e;return e=function(t){var e;return"P"===(e=t.tagName)||"DIV"===e},(t=function(r){return function(o){var n,i,s,u;if(o instanceof r.plugin.editor.getWin().Text)return o.textContent.replace(/\u2003/g,"	");if("BR"===o.tagName)return"\n";for(i="",n=s=0,u=o.childNodes.length;u>=0?u>s:s>u;n=u>=0?++s:--s)n>0&&(e(o.childNodes[n-1])||e(o.childNodes[n]))&&(i+="\n"),(n<o.childNodes.length-1||"BR"!==o.childNodes[n].tagName)&&(i+=t(o.childNodes[n]));return i}}(this))(this.contentAsFragment())},window.Group.prototype.setContentAsCode=function(t){return this.setContentAsText(Group.codeToHTML(t))},window.Group.codeToHTML=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\n/g,"<br>").replace(/\t/g,"&emsp;")}}).call(this);
//# sourceMappingURL=main-app-group-class-solo.min.js.map