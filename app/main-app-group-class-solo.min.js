(function(){var t,r=[].slice,e=[].indexOf||function(t){for(var r=0,e=this.length;e>r;r++)if(r in this&&this[r]===t)return r;return-1};window.Group.prototype.canonicalForm=function(){var t;return 0===this.children.length?OM.str(this.contentAsText()):OM.app.apply(OM,function(){var r,e,n,o;for(n=this.children,o=[],r=0,e=n.length;e>r;r++)t=n[r],o.push(t.canonicalForm());return o}.call(this))},window.Group.prototype.attributeGroups=function(t){var r,e,n,o,i,s,u;for(null==t&&(t=!1),n=[],u=this.connectionsIn(),i=0,s=u.length;s>i;i++)if(r=u[i],o=tinymce.activeEditor.Groups[r[0]],e=o.get("key")){if(!t&&"premise"===e)continue;n.push(o)}return n},window.Group.prototype.attributeGroupsForKey=function(t){var r,e,n,o,i;for(o=this.attributeGroups(!0),i=[],e=0,n=o.length;n>e;e++)r=o[e],r.get("key")===t&&i.push(r);return i},window.Group.prototype.attributionAncestry=function(t){var n,o,i,s,u,c,p,l,a;for(null==t&&(t=!1),i=[],l=this.attributeGroups(t),s=0,c=l.length;c>s;s++)for(n=l[s],a=[n].concat(r.call(n.attributionAncestry())),u=0,p=a.length;p>u;u++)o=a[u],e.call(i,o)<0&&i.push(o);return i},window.Group.prototype.listSymbol=OM.sym("List","Lurch"),window.Group.prototype.completeForm=function(t){var e,n,o,i,s,u,c,p,l,a,h,d,f,g,m,y,v,b,w;for(null==t&&(t=!1),l=this.canonicalForm(),p={},v=this.attributeGroups(t),h=0,g=v.length;g>h;h++)i=v[h],s=i.get("key"),(null!=p[s]?p[s]:p[s]=[]).push(i);for(b=this.keys(),d=0,m=b.length;m>d;d++)s=b[d],(e=OM.decodeIdentifier(s))&&null==p[e]&&(p[e]=[]);for(s in p){for(u=p[s],(n=this.get(OM.encodeAsIdentifier(s)))&&u.push(this),c=[],a=function(t,r){return strictNodeComparator(t.open,r.open)},w=u.sort(a),f=0,y=w.length;y>f;f++)i=w[f],i===this?(o=OM.decode(n.m),"a"===o.type&&o.children[0].equals(Group.prototype.listSymbol)?c=c.concat(o.children.slice(1)):c.push(o)):c.push(i.completeForm(t));l=OM.att(l,OM.sym(s,"Lurch"),1===c.length?c[0]:OM.app.apply(OM,[Group.prototype.listSymbol].concat(r.call(c))))}return l},window.Group.prototype.embedAttribute=function(t,n){var o,i,s,u;return null==n&&(n=!0),i=function(){var r,e,n,i;for(n=this.attributeGroups(),i=[],r=0,e=n.length;e>r;r++)o=n[r],o.get("key")===t&&i.push(o);return i}.call(this),s=OM.encodeAsIdentifier(t),u={m:1===i.length?i[0].completeForm():OM.app.apply(OM,[Group.prototype.listSymbol].concat(r.call(function(){var t,r,e;for(e=[],t=0,r=i.length;r>t;t++)o=i[t],e.push(o.completeForm());return e}())))},u.m=u.m.encode(),this.plugin.editor.undoManager.transact(function(t){return function(){var c,p,l,a,h,d,f,g,m,y,v,b,w,G,M,O;for(u.v="",m=0,b=i.length;b>m;m++){for(d=i[m],M=d.connectionsOut(),y=0,w=M.length;w>y;y++)h=M[y],g=tinymce.activeEditor.Groups[h[1]],d.disconnect(g);$(d.open).addClass("mustreconnect"),a=d.attributionAncestry(),a.sort(strictNodeComparator),u.v.length>0&&(u.v+="\n"),u.v+=function(){var t,e,n,i;for(n=[d].concat(r.call(a)),i=[],t=0,e=n.length;e>t;t++)o=n[t],i.push(o.groupAsHTML(!1));return i}().join("")}if(u.v=compressWrapper(u.v),t.set(s,u),n){for(O=[],v=0,G=i.length;G>v;v++)d=i[v],d.remove(),a=d.attributionAncestry(),a.sort(strictNodeComparator),l=[d.id()].concat(r.call(function(){var t,r,e;for(e=[],t=0,r=a.length;r>t;t++)c=a[t],e.push(c.id());return e}())),O.push(function(){var t,r,n,o,i,s,u;for(u=[],t=0,r=a.length;r>t;t++){for(p=a[t],f=!1,i=p.connectionsOut(),o=0,n=i.length;n>o;o++)if(h=i[o],s=h[1],e.call(l,s)<0){f=!0;break}u.push(f?void 0:p.remove())}return u}());return O}}}(this))},window.Group.prototype.unembedAttribute=function(t,r){var e,n,o,i,s,u;if(null==r&&(r=!1),u=this.get(OM.encodeAsIdentifier(t))){for(n=decompressWrapper(u.v),i=OM.decode(u.m),e=/class=('[^']*grouper[^']*'|"[^"]*grouper[^"]*")/,s="";o=e.exec(n);)s+=n.substr(0,o.index)+o[0].substr(0,o[0].length-1)+" justPasted"+o[0].substr(o[0].length-1),n=n.substr(o.index+o[0].length);return s+=n,this.plugin.editor.undoManager.transact(function(e){return function(){var n;return r||(n=e.rangeAfter(),n.collapse(!0),e.plugin.editor.selection.setRng(n)),e.plugin.editor.insertContent(s),e.plugin.scanDocument(),$(e.plugin.editor.getDoc()).find(".grouper.mustreconnect").each(function(r,n){var o;return o=e.plugin.grouperToGroup(n),o.connect(e),o.set("key",t),o.get("keyposition")||o.set("keyposition","arrow"),$(n).removeClass("mustreconnect")}),e.clear(OM.encodeAsIdentifier(t))}}(this))}},t=5e4,window.compressWrapper=function(r){var e,n,o,i,s,u,c;for(n=/<img\s+([^>]*)\s+src=('[^']*'|"[^"]*")([^>]*)>/;i=n.exec(r);)r=r.substr(0,i.index)+("<img "+i[1]+" "+i[2]+">")+r.substr(i.index+i[0].length);for(r=LZString.compress(r),s="",o=u=0,c=r.length;c>=0?c>u:u>c;o=c>=0?++u:--u)s+=(e=r.charCodeAt(o))<t?r[o]:String.fromCharCode(5e4)+String.fromCharCode(e-5e4);return s},window.decompressWrapper=function(r){var e,n;for(n="";r.length>0;)(e=r.charCodeAt(0))<t?(n+=r[0],r=r.substr(1)):(n+=String.fromCharCode(e+r.charCodeAt(1)),r=r.substr(2));return LZString.decompress(n)}}).call(this);
//# sourceMappingURL=main-app-group-class-solo.min.js.map