(function(){var t,e=[].slice,r=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};window.Group.prototype.canonicalForm=function(){var t;return 0===this.children.length?OM.str(this.contentAsCode()):OM.app.apply(OM,function(){var e,r,n,o;for(n=this.children,o=[],e=0,r=n.length;r>e;e++)t=n[e],o.push(t.canonicalForm());return o}.call(this))},window.Group.prototype.attributeGroups=function(t){var e,r,n,o,i,u,s;for(null==t&&(t=!1),n=[],s=this.connectionsIn(),i=0,u=s.length;u>i;i++)if(e=s[i],o=tinymce.activeEditor.Groups[e[0]],r=o.get("key")){if(!t&&"premise"===r)continue;n.push(o)}return n},window.Group.prototype.attributeGroupsForKey=function(t){var e,r,n,o,i;for(o=this.attributeGroups(!0),i=[],r=0,n=o.length;n>r;r++)e=o[r],e.get("key")===t&&i.push(e);return i},window.Group.prototype.attributionAncestry=function(t){var n,o,i,u,s,c,p,a,l;for(null==t&&(t=!1),i=[],a=this.attributeGroups(t),u=0,c=a.length;c>u;u++)for(n=a[u],l=[n].concat(e.call(n.attributionAncestry())),s=0,p=l.length;p>s;s++)o=l[s],r.call(i,o)<0&&i.push(o);return i},window.Group.prototype.listSymbol=OM.sym("List","Lurch"),window.Group.prototype.completeForm=function(t){var r,n,o,i,u,s,c,p,a,l,h,d,g,f,m,y,v,b,w;for(null==t&&(t=!1),a=this.canonicalForm(),p={},v=this.attributeGroups(t),h=0,f=v.length;f>h;h++)i=v[h],u=i.get("key"),(null!=p[u]?p[u]:p[u]=[]).push(i);for(b=this.keys(),d=0,m=b.length;m>d;d++)u=b[d],(r=OM.decodeIdentifier(u))&&null==p[r]&&(p[r]=[]);for(u in p){for(s=p[u],(n=this.get(OM.encodeAsIdentifier(u)))&&s.push(this),c=[],l=function(t,e){return strictNodeComparator(t.open,e.open)},w=s.sort(l),g=0,y=w.length;y>g;g++)i=w[g],i===this?(o=OM.decode(n.m),"a"===o.type&&o.children[0].equals(Group.prototype.listSymbol)?c=c.concat(o.children.slice(1)):c.push(o)):c.push(i.completeForm(t));a=OM.att(a,OM.sym(u,"Lurch"),1===c.length?c[0]:OM.app.apply(OM,[Group.prototype.listSymbol].concat(e.call(c))))}return a},window.Group.prototype.lookupAttributes=function(t){var e,r,n,o,i,u,s,c,p;for(o=this.attributeGroupsForKey(t),(e=this.get(OM.encodeAsIdentifier(t)))&&o.push(this),i=[],u=function(t,e){return strictNodeComparator(t.open,e.open)},p=o.sort(u),s=0,c=p.length;c>s;s++)n=p[s],n===this?(r=OM.decode(e.m),"a"===r.type&&r.children[0].equals(Group.prototype.listSymbol)?i=i.concat(r.children.slice(1)):i.push(r)):i.push(n);return i},window.Group.prototype.embedAttribute=function(t,n){var o,i,u,s;return null==n&&(n=!0),i=function(){var e,r,n,i;for(n=this.attributeGroups(),i=[],e=0,r=n.length;r>e;e++)o=n[e],o.get("key")===t&&i.push(o);return i}.call(this),u=OM.encodeAsIdentifier(t),s={m:1===i.length?i[0].completeForm():OM.app.apply(OM,[Group.prototype.listSymbol].concat(e.call(function(){var t,e,r;for(r=[],t=0,e=i.length;e>t;t++)o=i[t],r.push(o.completeForm());return r}())))},s.m=s.m.encode(),this.plugin.editor.undoManager.transact(function(t){return function(){var c,p,a,l,h,d,g,f,m,y,v,b,w,G,M,A;for(s.v="",m=0,b=i.length;b>m;m++){for(d=i[m],M=d.connectionsOut(),y=0,w=M.length;w>y;y++)h=M[y],f=tinymce.activeEditor.Groups[h[1]],d.disconnect(f);$(d.open).addClass("mustreconnect"),l=d.attributionAncestry(),l.sort(strictNodeComparator),s.v.length>0&&(s.v+="\n"),s.v+=function(){var t,r,n,i;for(n=[d].concat(e.call(l)),i=[],t=0,r=n.length;r>t;t++)o=n[t],i.push(o.groupAsHTML(!1));return i}().join("")}if(s.v=compressWrapper(s.v),t.set(u,s),n){for(A=[],v=0,G=i.length;G>v;v++)d=i[v],d.remove(),l=d.attributionAncestry(),l.sort(strictNodeComparator),a=[d.id()].concat(e.call(function(){var t,e,r;for(r=[],t=0,e=l.length;e>t;t++)c=l[t],r.push(c.id());return r}())),A.push(function(){var t,e,n,o,i,u,s;for(s=[],t=0,e=l.length;e>t;t++){for(p=l[t],g=!1,i=p.connectionsOut(),o=0,n=i.length;n>o;o++)if(h=i[o],u=h[1],r.call(a,u)<0){g=!0;break}s.push(g?void 0:p.remove())}return s}());return A}}}(this))},window.Group.prototype.unembedAttribute=function(t,e){var r,n,o,i,u,s;if(null==e&&(e=!1),s=this.get(OM.encodeAsIdentifier(t))){for(n=decompressWrapper(s.v),i=OM.decode(s.m),r=/class=('[^']*grouper[^']*'|"[^"]*grouper[^"]*")/,u="";o=r.exec(n);)u+=n.substr(0,o.index)+o[0].substr(0,o[0].length-1)+" justPasted"+o[0].substr(o[0].length-1),n=n.substr(o.index+o[0].length);return u+=n,this.plugin.editor.undoManager.transact(function(r){return function(){var n;return e||(n=r.rangeAfter(),n.collapse(!0),r.plugin.editor.selection.setRng(n)),r.plugin.editor.insertContent(u),r.plugin.scanDocument(),$(r.plugin.editor.getDoc()).find(".grouper.mustreconnect").each(function(e,n){var o;return o=r.plugin.grouperToGroup(n),o.connect(r),o.set("key",t),o.get("keyposition")||o.set("keyposition","arrow"),$(n).removeClass("mustreconnect")}),r.clear(OM.encodeAsIdentifier(t))}}(this))}},t=5e4,window.compressWrapper=function(e){var r,n,o,i,u,s,c;for(n=/<img\s+([^>]*)\s+src=('[^']*'|"[^"]*")([^>]*)>/;i=n.exec(e);)e=e.substr(0,i.index)+("<img "+i[1]+" "+i[2]+">")+e.substr(i.index+i[0].length);for(e=LZString.compress(e),u="",o=s=0,c=e.length;c>=0?c>s:s>c;o=c>=0?++s:--s)u+=(r=e.charCodeAt(o))<t?e[o]:String.fromCharCode(5e4)+String.fromCharCode(r-5e4);return u},window.decompressWrapper=function(e){var r,n;for(n="";e.length>0;)(r=e.charCodeAt(0))<t?(n+=e[0],e=e.substr(1)):(n+=String.fromCharCode(r+e.charCodeAt(1)),e=e.substr(2));return LZString.decompress(n)},window.Group.prototype.contentAsCode=function(){var t,e;return e=function(t){var e;return"P"===(e=t.tagName)||"DIV"===e},(t=function(r){return function(n){var o,i,u,s;if(n instanceof r.plugin.editor.getWin().Text)return n.textContent.replace(/\u2003/g,"	");if("BR"===n.tagName)return"\n";for(i="",o=u=0,s=n.childNodes.length;s>=0?s>u:u>s;o=s>=0?++u:--u)o>0&&(e(n.childNodes[o-1])||e(n.childNodes[o]))&&(i+="\n"),(o<n.childNodes.length-1||"BR"!==n.childNodes[o].tagName)&&(i+=t(n.childNodes[o]));return i}}(this))(this.contentAsFragment())},window.Group.prototype.setContentAsCode=function(t){return this.setContentAsText(Group.codeToHTML(t))},window.Group.codeToHTML=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\n/g,"<br>").replace(/\t/g,"&emsp;")}}).call(this);
//# sourceMappingURL=main-app-group-class-solo.min.js.map