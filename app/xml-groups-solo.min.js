(function(){var e,t,n,i,o,a={}.hasOwnProperty,r=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};o={},window.setTagData=function(e){return o=e},window.addTagData=function(e){var t,n,i;i=[];for(t in e)a.call(e,t)&&(n=e[t],i.push(o[t]=n));return i},window.pluginsToLoad=["dialogs"],window.setGroupTag=function(e,t){return e.set("tagName",t)},window.getGroupTag=function(e){return e.get("tagName")},window.initializeGroupTag=function(e){var t,n;return t=e.parent?window.getGroupTag(e.parent):window.topLevelTagName(),n=window.getTagData(t,"defaultChild"),n?window.setGroupTag(e,n):void 0},window.getTagData=function(e,t){var n;return e instanceof window.Group&&(e=window.getGroupTag(e)),null!=(n=o[e])?n[t]:void 0},window.getTagExternalName=function(e){var t;return e instanceof window.Group&&(e=window.getGroupTag(e)),null!=(t=window.getTagData(e,"externalName"))?t:e},window.topLevelTagName=function(){var e,t;for(e in o)if(a.call(o,e)&&(t=o[e],t.topLevel))return e},window.XMLMenuItems=function(e){var t,n,i,a,r,l,u;return r=[],null!=(l=window.getGroupTag(e))&&(i=window.getTagExternalName(l),null!=(n=window.getTagData(l,"documentation"))&&(n=n.replace(/a href=/g,'a target="_blank" href='),r.push({text:'Read "'+i+'" documentation',onclick:function(){return tinymce.activeEditor.Dialogs.alert({title:'Documentation for "'+i+'"',message:n})}}))),r.push({text:"View XML representation",onclick:function(){var t;return t=window.convertToXML(e).replace(/&/g,"&amp;").replace(/</g,"&lt;"),tinymce.activeEditor.Dialogs.alert({title:"XML Representation",width:600,message:'<html>\n    <head>\n        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">\n        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>\n    </head>\n    <body>\n        <pre><code class=\'xml\'>'+t+"</code></pre>\n        <script>hljs.initHighlightingOnLoad();</script>\n    </body>\n</html>"})}}),a=e.parent?window.getGroupTag(e.parent):window.topLevelTagName(),t=window.getTagData(a,"allowedChildren"),r.push({text:"Change tag to...",menu:function(){var n,i,a,r;for(a=Object.keys(o).sort(),r=[],n=0,i=a.length;i>n;n++)u=a[n],r.push(function(n){return{text:window.getTagExternalName(n),disabled:null!=t&&!(n in t),onclick:function(){return e.set("tagName",n)}}}(u));return r}()}),r},window.groupToolbarButtons={viewxml:{text:"XML",tooltip:"View XML representation of this document",onclick:function(){var n,i,o,a,r,l,u,c;for(r=[],o=tinymce.activeEditor,c=o.Groups.ids(),l=0,u=c.length;u>l;l++)if(a=c[l],!t(o.Groups[a])){r.push("At least one element in your document has errors (indicated by a red X following the element).");break}return n=window.getTagData(window.topLevelTagName(),"allowedChildren"),n&&(r=r.concat(e(o.Groups.topLevel,n,"document"))),i=function(){var e;return e=window.convertToXML().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),tinymce.activeEditor.Dialogs.alert({title:"XML Representation",width:800,height:600,message:'<html>\n    <head>\n        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">\n        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>\n    </head>\n    <body>\n        <pre><code class=\'xml\'>'+e+"</code></pre>\n        <script>hljs.initHighlightingOnLoad();</script>\n    </body>\n</html>"})},0===r.length?i():tinymce.activeEditor.Dialogs.confirm({title:"Problems with your document",message:"<p><b>The problems listed below exist in your document.</b></p> <ul><li>"+r.join("</li><li>")+"</li></ul> <p>You can click OK to generate XML anyway, but it may be invalid.  Click Cancel to go back and fix these problems first.</b></p>",okCallback:i})}}},window.XMLGroupChanged=function(e,t){return t&&!e.get("tagName")&&setTimeout(function(){return window.initializeGroupTag(e)},0),window.validateHierarchy(e)},window.XMLGroupDeleted=function(e){var t;if(null!=e.parent){if(e.parent.children[0])return window.validateHierarchy(e.parent.children[0])}else if(null!=(t=e.plugin)?t.topLevel[0]:void 0)return window.validateHierarchy(e.plugin.topLevel[0])},n=function(e){return e.set("valid",!0),e.clear("closeDecoration"),e.clear("closeHoverText")},i=function(e,t){return e.set("valid",!1),e.set("closeDecoration",'<font color="red">&#10006;</font>'),e.set("closeHoverText",t)},t=function(e){return e.get("valid")},window.validateHierarchy=function(t){var o,a,l,u,c,d,g,s,w,h,p,f,m,v,T,y;if(T=[],!t.children)return void setTimeout(function(){return window.validateHierarchy(t)},100);if(null==(s=window.getGroupTag(t))&&T.push("Each element must have a tag, but this one does not.  Add a tag using the context menu."),p=t.parent?window.getGroupTag(t.parent):window.topLevelTagName(),u=window.getTagData(t,"belongsIn"),"string"==typeof u&&(u=[u]),u instanceof Array&&r.call(u,p)<0&&(g=window.getTagExternalName(t),m=window.getTagExternalName(p),c=function(){var e,t,n;for(n=[],e=0,t=u.length;t>e;e++)a=u[e],n.push(window.getTagExternalName(a));return n}(),m=m?""+m+" elements":"in an element without a tag",c=function(){var e,t,n;for(n=[],e=0,t=u.length;t>e;e++)a=u[e],n.push(window.getTagExternalName(a));return n}(),f=function(){switch(c.length){case 1:return"this kind of element: "+c[0];case 2:return"these kinds of elements: "+c.join(" and ");default:return"these kinds of elements: "+c.join(", ")}}(),T.push(""+g+" elements are only permitted in "+f+" (not "+m+").")),v=t.previousSibling()?window.getGroupTag(t.previousSibling()):null,l=window.getTagData(t,"belongsAfter"),"string"==typeof u&&(l=[l]),null===l&&(l=[null]),l instanceof Array&&r.call(l,v)<0&&(g=window.getTagExternalName(t),m=window.getTagExternalName(v),m=m?""+m+" elements":"being first in their context",c=function(){var e,t,n,i;for(i=[],e=0,t=l.length;t>e;e++)a=l[e],i.push(null!=(n=window.getTagExternalName(a))?n:"none (i.e., being the first in their context)");return i}(),f=function(){switch(c.length){case 1:return"this kind of element: "+c[0];case 2:return"these kinds of elements: "+c.join(" and ");default:return"these kinds of elements: "+c.join(", ")}}(),T.push(""+g+" elements are only permitted to follow "+f+" (not "+m+").")),window.getTagData(t,"unique"))for(y=t;y=y.previousSibling();)if(window.getGroupTag(y)===s){T.push('Each context may contain only one "'+window.getTagExternalName(t)+'" element.  But there is already an earlier one in this context, making this one invalid.');break}return(o=window.getTagData(t,"allowedChildren"))&&(T=T.concat(e(t.children,o))),(d=window.getTagData(t,"contentCheck"))&&(w=d(t),w instanceof Array&&(T=T.concat(w))),T.length>0?i(t,T.join("\n")):n(t),(h=t.nextSibling())?window.validateHierarchy(h):void 0},e=function(e,t,n){var i,o,r,l,u,c,d,g,s,w,h,p,f,m;for(null==n&&(n="element"),g=[],l={},p=0,f=e.length;f>p;p++)i=e[p],o=window.getGroupTag(i),null==l[o]&&(l[o]=0),l[o]++;for(s in t)a.call(t,s)&&null==l[s]&&(l[s]=0);for(s in l)a.call(l,s)&&(r=l[s],t.hasOwnProperty(s)&&(m=t[s],d=m[0],c=m[1],null!=d&&null!=c&&"number"==typeof d&&"number"==typeof c&&(w=1===r?"is":"are",h=1===d?"child":"children",u=window.getTagExternalName(s),d>r&&g.push("The "+n+" requires at least "+d+" "+h+" with tag "+u+", but there "+w+" "+r+" in this "+n+"."),h=1===c?"child":"children",r>c&&g.push("The "+n+" permits at most "+c+" "+h+" with tag "+u+", but there "+w+" "+r+" in this "+n+"."))));return g},window.convertToXML=function(e){var t,n,i,a,r,l,u,c,d,g,s,w,h;return null!=e?(i=e.children,d=window.getGroupTag(e)):(i=tinymce.activeEditor.Groups.topLevel,d=window.topLevelTagName()),c=function(e){var t;return"P"===(t=e.tagName)||"DIV"===t},s=function(e){return function(e){var t,n,i,o,a;if(null!=e.cloneContents&&(i=document.createElement("div"),i.appendChild(e.cloneContents()),console.log(i),e=i),3===(null!=e?e.nodeType:void 0))return e.textContent.replace(/\u2003/g,"  ");if("BR"===e.tagName)return"\n";for(n="",t=o=0,a=e.childNodes.length;a>=0?a>o:o>a;t=a>=0?++o:--o)t>0&&(c(e.childNodes[t-1])||c(e.childNodes[t]))&&(n+="\n"),(t<e.childNodes.length-1||"BR"!==e.childNodes[t].tagName)&&(n+=s(e.childNodes[t]));return n}}(this),h=window.getTagData(d,"includeText"),w=function(e){var t,n;return h?o.hasOwnProperty(h)?(n="<"+h+">"+e+"</"+h+">",(t=window.getTagData(h,"alterXML"))&&(n=t(n)),n):e:""},u=function(){var t,o;if(i.length){for(a=function(e){return"  "+e.replace(RegExp("\n","g"),"\n  ")},l=i[0].rangeBefore(),r="",/^\s*$/.test(l.toString())||(r+=w(s(l))),t=0,o=i.length;o>t;t++)n=i[t],"\n"!==r[r.length-1]&&(r+="\n"),r+=""+window.convertToXML(n)+"\n",l=n.rangeAfter(),/^\s*$/.test(l.toString())||(r+=w(s(l)));return"<"+d+">\n"+a(r)+"\n</"+d+">"}return g=window.getTagData(d,"rawXML")?null!=e?s(e.contentAsFragment()):tinymce.activeEditor.getContent({format:"text"}).replace(/\xA0/g,"\n"):tinymce.DOM.encode(null!=e?e.contentAsHTML():tinymce.activeEditor.getContent()),null==h&&(h=!0),"<"+d+">"+w(g)+"</"+d+">"}(),(t=window.getTagData(d,"alterXML"))&&(u=t(u,e)),u}}).call(this);
//# sourceMappingURL=xml-groups-solo.min.js.map