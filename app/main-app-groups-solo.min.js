(function(){var t,e=[].slice;window.groupTypes=[{name:"expression",text:"Expression",imageHTML:'<font color="#996666">[ ]</font>',openImageHTML:'<font color="#996666">[</font>',closeImageHTML:'<font color="#996666">]</font>',tooltip:"Make the selected text an expression",color:"#996666",shortcut:"Ctrl+[",LaTeXshortcut:"\\[",connectionRequest:function(t,e){var n;return n=function(t,e){var o,i,r,a,c;if(t===e)return!0;for(c=t.connectionsOut(),r=0,a=c.length;a>r;r++)if(o=c[r],i=tinymce.activeEditor.Groups[o[1]],n(i,e))return!0;return!1},n(e,t)?t.plugin.editor.Dialogs.alert({title:"Cannot connect expressions",message:"Forming that connection would create a cycle of connections among expressions, which is not permitted."}):tinymce.activeEditor.undoManager.transact(function(){return t.connect(e),t.get("key")||t.set("key","label"),t.get("keyposition")?void 0:t.set("keyposition","arrow")})},connections:function(t){var n,o,i,r,a,c,u,s;for(i=t.connectionsOut(),o=t.connectionsIn(),s=e.call(o).concat(e.call(i)),c=0,u=s.length;u>c;c++)n=s[c],r=tinymce.activeEditor.Groups[n[0]],"arrow"===r.get("keyposition")&&(n[2]=r.get("key")),"premise"===r.get("key")&&(n[3]=function(t){return t.setLineDash([3,3])});return e.call(i).concat(e.call(o),e.call(function(){var t,e,n;for(n=[],t=0,e=i.length;e>t;t++)a=i[t],n.push(a[1]);return n}()),e.call(function(){var t,e,n;for(n=[],t=0,e=o.length;e>t;t++)a=o[t],n.push(a[0]);return n}()))},tagContents:function(t){return"source"===t.get("keyposition")?t.get("key"):null},tagMenuItems:function(e){var n;return n=[],e.connectionsOut().length>0&&"source"===e.get("keyposition")&&(n.push({text:'Move "'+e.get("key")+'" onto arrow',onclick:function(){return tinymce.activeEditor.undoManager.transact(function(){return e.set("keyposition","arrow")})}}),n.push(t(e))),n},contextMenuItems:function(e){var n,o,i,r,a,c,u,s,l,g,d,h,f,p,y,m;if(s=[],r=e.connectionsOut(),a=e.get("key"),r.length>0&&("arrow"===e.get("keyposition")&&s.push({text:'Move "'+e.get("key")+'" onto attribute',onclick:function(){return tinymce.activeEditor.undoManager.transact(function(){return e.set("keyposition","source")})}}),s.push(t(e))),r.length>0&&"premise"!==a){for(h=function(){var t,e,n;for(n=[],t=0,e=r.length;e>t;t++)i=r[t],n.push(tinymce.activeEditor.Groups[i[1]]);return n}(),n=!0,f=0,y=h.length;y>f;f++)if(d=h[f],d.attributeGroupsForKey(a).length>1){n=!1;break}if(n)s.push({text:"Hide this attribute",onclick:function(){var t,n,o;return t=function(){return tinymce.activeEditor.undoManager.transact(function(){var t,n,o,i,r;for(r=[],t=o=0,i=h.length;i>o;t=++o)d=h[t],n=t===h.length-1,d.embedAttribute(a,n),r.push(n?void 0:e.connect(h[t+1]));return r})},o="",h.length>1&&(o+="You are hiding this attribute in "+h.length+" expressions.  "),n=e.attributionAncestry(!0).length-e.attributionAncestry(!1).length,n>0&&(o+="There are "+n+" premise connections that will be broken if you hide that attribute.  "),o.length>0?tinymce.activeEditor.Dialogs.confirm({title:"Warning",message:""+o+"Continue anyway?",okCallback:t}):t()}});else if(1===h.length){for(d=h[0],g=d.attributeGroupsForKey(a),o=!1,p=0,m=g.length;m>p;p++)if(l=g[p],l.connectionsOut().length>1){o=!0;break}o||s.push({text:"Hide this attribute",onclick:function(){var t,n,o,i,r;for(t=function(){return tinymce.activeEditor.undoManager.transact(function(){var t,n,o,i,r;for(r=[],t=o=0,i=h.length;i>o;t=++o)d=h[t],n=t===h.length-1,d.embedAttribute(a,n),r.push(n?void 0:e.connect(h[t+1]));return r})},o="You are about to hide not one attribute, but "+g.length+", all of type "+a+".  ",n=0,i=0,r=g.length;r>i;i++)l=g[i],n+=l.attributionAncestry(!0).length-l.attributionAncestry(!1).length;return n>0&&(o+="There are "+n+" premise connections that will be broken if you hide that attribute.  "),o.length>0?tinymce.activeEditor.Dialogs.confirm({title:"Warning",message:""+o+"Continue anyway?",okCallback:t}):t()}})}}return s.push({text:"Attributes...",onclick:window.attributesActionForGroup(e)}),(c=e.lookupAttributes("code")).length>0&&(u=c[c.length-1],u instanceof Group&&(u=u.canonicalForm()),"st"===u.type&&s.push({text:"Edit as code...",onclick:function(){return e.plugin.editor.Dialogs.codeEditor({value:e.contentAsCode(),okCallback:function(t){return e.plugin.editor.undoManager.transact(function(){return e.setContentAsCode(t)})}})}})),s},clicked:function(t,e,n){return"double"===e&&"close"===n?tinymce.activeEditor.Dialogs.waiting({title:"Just sit tight",message:"Waiting...",work:function(e){return t.computeValidationAsync(function(t){var n;return e(),tinymce.activeEditor.Dialogs.alert({title:"Validation details",message:"<table> <tr><td>Result:</td> <td>"+t.result+"</td></tr> <tr><td>Explanation:</td> <td>"+t.message+"</td></tr> <tr><td>Details:</td> <td>"+(null!=(n=t.verbose)?n:"(none available)")+"</td></tr> </table>"})},!0)}}):void 0}}],t=function(t){var e,n;return n=function(e){return tinymce.activeEditor.undoManager.transact(function(){return t.set("key",e)})},e=function(t){return{text:t,onclick:function(){return n(t.toLowerCase())}}},{text:"Change attribute key to...",menu:[e("Label"),e("Reason"),e("Premise"),e("Rule"),e("Code"),{text:"Other...",onclick:function(){return tinymce.activeEditor.Dialogs.prompt({title:"Enter new key",message:'Change "'+t.get("key")+'" to what?',okCallback:function(t){return/^[a-zA-Z0-9-_]+$/.test(t)?n(t):void tinymce.activeEditor.Dialogs.alert({title:"Invalid key",message:"Keys can only contain Roman letters, decimal digits, hyphens, and underscores (no spaces or other punctuation).",width:300,height:200})}})}}]}}}).call(this);
//# sourceMappingURL=main-app-groups-solo.min.js.map